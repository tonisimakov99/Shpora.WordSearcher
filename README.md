# Shpora.WordSearcher
Решение тестового задания для поступления в "Шпору" - школа промышленной разработки от СКБ-Контура.

Задача.

Дан игровой веб-сервис WordSearcher (http://shpora.skbkontur.ru)

Описание
 
Веб-сервис имеет RESTful api. Методы api описаны в конце документа.
                                                                                                                     
Зайдя на данный веб-сервис, ты можешь сыграть в игру, состоящую из одного случайно сгенерированного уровня.
Игровое поле является проекцией поверхности тороида на двумерное поле. Тороид, как и поле состоит из клеток двух видов: пустые и непустые.
Комбинации непустых клеток обязательно формируют кириллические буквы. Каждая буква единственным образом вписана в квадрат со стороной 7 клеток так, что границы этого квадрата удается достоверно определить. 
Если буквы находятся на расстоянии одной клетки друг от друга в горизонтальной проекции, а по вертикали они находятся на одном уровне (в одну линию), то они образуют слово (максимальное по включению). Расстоянием между буквами считается расстояние между квадратами, в которые вписаны эти буквы. Все слова являются словами русского языка длиной не менее двух букв. Буквы не могут быть перевёрнуты.

Известно, что все слова, написанные на тороиде - уникальны. Количество слов - неизвестно.

Возможности API:

инициализация и завершение игровой сессии
перемещение по полю
отправка найденных слов
получение игровой статистики

Ограничения API:

не более одного единовременного подключения на api-key

Система начисления очков:

L = длина найденного слова
F = число уже найденных слов

при старте игровой сессии, у тебя 0 очков
за каждый шаг с тебя списывается 1 очко
допустимо иметь отрицательное число очков
за каждое корректно найденное слово, тебе начисляется  20 * L * F
за каждое некорректное (в т.ч. неуникальное) слово тебе начисляется штраф эквивалентный награде за следующее успешно найденное слово
для зачисления всех полученных очков, тебе нужно корректно завершить сессию, в противном случае - очки будут обнулены и не засчитаны
игровая сессия существует ограниченное время
если игровая сессия завершилась по таймауту, то набранные очки засчитаны не будут

Твоя задача - написать клиента, который набирает максимальное число очков за одну игру.


Оформление решения:

Решение должно представлять собой solution для Visual Studio, упакованный в zip-архив следующим образом:
/Shpora.WordSearcher.sln
/Shpora.WordSearcher/Shpora.WordSearcher.csproj
…

Папки bin, obj и packages включать в архив не надо.

Решение не должно требовать никакого предустановленного ПО, кроме .NET Framework 4.7.2. 
Решение может содержать nuget-зависимости.
Решение может зависеть и от сторонних библиотек не из nuget, в таком случае они должны быть включены в решение (проверьте правильность путей в references).
Решение может содержать любое количество проектов, но запущен будет исполняемый файл проекта Shpora.WordSearcher.


После сборки командой nuget restore && msbuild /p:Configuration=Release должен появиться файл /Shpora.WordSearcher/bin/Release/Shpora.WordSearcher.exe, который будет использован для запуска приложения.

Клиент должен принимать 2 аргумента командной строки: 
Shpora.WordSearcher.exe <server> <auth_key>

server - URI игрового сервера (прим: http://shpora.skbkontur.ru:80/)
auth_key - произвольная строка, которая является ключом аутентификации в API 

Пример запуска:
Shpora.WordSearcher.exe https://shpora.skbkontur.ru 08175b8b-743b-47fc-85a4-64986819548d


Получение ключа аутентификации

Авторизационный ключ получается на http://shpora.skbkontur.ru.

Проверка решения

Проверка состоит из двух этапов: автоматический запуск клиента на серии случайно сгенерированных карт и code review. Сгенерированная серия карт одинакова для всех клиентов.

На первом этапе решения получат баллы за прохождение карт. Если решение покажет себя совсем плохо, то во второй этап оно не попадет.

На втором этапе будут оценены чистота кода и навыки проектирования архитектуры.

Авторов решений, показавших лучшие оценки на обоих этапах, мы позовем на собеседование.

API

== Инициализация игровой сессии ==
При указанном query параметре test=true, ты попадешь на тестовую карту, где присутствуют все возможные буквы (размер тестовой карты 100х100). При проверке решений, эта карта не будет доступна.
->
POST /task/game/start HTTP/1.1
Authorization: token <auth_key>

<-
HTTP/1.1 200 OK
Expires: <http_date> //таймаут сессии в секундах
Last-Modified: <http_date> //время инициализации сессии

== Завершение игровой сессии ==
->
POST /task/game/finish HTTP/1.1
Authorization: token <auth_key>

<-
HTTP/1.1 200 OK
Content-Type: application/json

{“points”: N }


== Получение текущей статистики по игровой сессии == 
->
GET /task/game/stats HTTP/1.1
Authorization: token <auth_key>

<-
HTTP/1.1 200 OK
Сontent-Type: application/json

{“words“: F, “points“: N, “moves”: X}

== Перемещение по игровому полю ==

(в теле ответа возвращается текущая видимая область (размер области всегда равен 5x11 клеток))
->
POST /task/move/{up,left,right,down} HTTP/1.1
Authorization: token <auth_key>

<-
HTTP/1.1 200 OK

10000010000
10001100001
10110000001
11000000011
10110000010

== Сдача найденных слов ==

->
POST /task/words/ HTTP/1.1
Authorization: token <auth_key>
Content-Type: application/json; charset=UTF-8

[“шпора”, “контур”, “словарь”]
<-
HTTP/1.1 200 OK
Content-Type: application/json

{“points”: N} (Количество очков, полученных за сданные в ЭТОМ запросе слова





================
ОШИБКИ СЕРВЕРА
================

Если нет authorization header:

HTTP/1.1 401 Unauthorized

Ecли authorization header некорректен

HTTP/1.1 403 Forbidden

Инициализация новой игровой сессии, при активной старой, или, попытка выполнить действие при отсутствии активной сессии.

HTTP/1.1 409 Conflict
State: <reinitialized, not initialized, timed out>

Попытка выполнить два одновременных запроса

HTTP/1.1 429 Too many requests

Предпроверка

Мы проведём предпроверку решений, присланных до 20.09! Если ты отправишь решение до этой даты, мы посмотрим его и отправим комментарии по его улучшению. Смотреть будем по ходу получения решений. Например, если ты отправишь решение в эту субботу, то ответ получишь в ближайшие пару дней. За время предпроверки мы посмотрим только одну версию твоего решения.

Для предпроверки решение должно быть рабочим - уметь подключаться к серверу и читать слова.

Отправить решение нужно до 20.09 13:00 ЕКБ. предпроверка не является обязательной, она нужна только если ты хочешь получить комментарии заранее и доработать своё решение к концу приёма тестовых.

